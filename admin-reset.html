<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Redefinir Senha - E2W</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root { --primary:#bfa14a; --primary-dark:#8c7a2a; --gray-900:#fff; --gray-700:#d0d0d0; }
        body { background:#000; color:var(--gray-900); font-family:Inter, Arial, sans-serif; min-height:100vh; display:flex; align-items:center; justify-content:center; }
        .card { background:#0b0b0b; border:1px solid rgba(191,161,74,0.18); border-radius:16px; padding:2rem; width:100%; max-width:480px; box-shadow:0 20px 60px rgba(0,0,0,0.5); }
        h2 { color:var(--primary); margin:0 0 1rem; }
        .form-group { margin-bottom:1rem; }
        label { display:block; margin-bottom:.4rem; color:var(--gray-700); }
        input { width:100%; padding:.9rem; border-radius:10px; background:#0f0f0f; border:1px solid rgba(191,161,74,0.22); color:#fff; }
        .btn { display:inline-flex; align-items:center; justify-content:center; gap:.5rem; padding:.9rem 1.2rem; border-radius:10px; font-weight:700; cursor:pointer; border:none; width:100%; }
        .btn-primary { background:var(--primary); color:#181818; }
    </style>
</head>
<body>
    <div class="card">
        <h2><i class="fas fa-unlock-alt"></i> Redefinir Senha</h2>
        <form id="resetForm">
            <div class="form-group">
                <label>Nova Senha</label>
                <input type="password" name="pwd1" required minlength="4" placeholder="Digite a nova senha">
            </div>
            <div class="form-group">
                <label>Confirmar Nova Senha</label>
                <input type="password" name="pwd2" required minlength="4" placeholder="Repita a nova senha">
            </div>
            <button class="btn btn-primary" type="submit">Salvar Senha</button>
        </form>
    </div>

    <script src="js/admin-auth.js"></script>
    <script>
        const params = new URLSearchParams(location.search);
        const email = params.get('email') || '';
        const form = document.getElementById('resetForm');
        form.addEventListener('submit', (e)=>{
            e.preventDefault();
            const fd = new FormData(form);
            const a = (fd.get('pwd1')||'').toString();
            const b = (fd.get('pwd2')||'').toString();
            if (a.length < 4){ alert('A senha deve ter ao menos 4 caracteres.'); return; }
            if (a !== b){ alert('As senhas não conferem.'); return; }
            window.AdminAuth.setPassword(a);
            window.AdminAuth.clearOtp();
            alert('✅ Senha redefinida com sucesso para o usuário E2W.');
            window.location.href = 'admin.login.html';
        });
    </script>
</body>
</html>
